<!doctype html>

<html lang="en">
<head>
    <title>FootTracker MapApp</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"
    integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ=="
    crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"
    integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg=="
    crossorigin=""></script>
    
    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">    

</head>

<body>
    <!-- # Menubar: Menubar on the top -->
    <div class="row">
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#"> FootTracker</a>
        </div>
        <ul class="nav navbar-nav">
          <li class="active"><a href="#">Home</a></li>
        </ul>
        <form id="searchID" class="navbar-form navbar-left">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Search Area" id="search-input" name="search[term]">
            <div class="input-group-btn">
              <button class="btn btn-default" type="submit">
                <i class="glyphicon glyphicon-search"></i>
              </button>
            </div>
          </div>
        </form>
      </div>
    </nav>
    </div> <!-- End of menu on the top -->
    
    <div class="row">
        <!-- # Menubar: Menubar on the left -->
        <div class="col-md-2">
           <button id="btn_restaurants" class="btn btn-success" style="display: block; width: 100%;" value="color">Restarants</button>
           <button id="btn_hotels" class="btn btn-success" style="display: block; width: 100%;" value="color">Hotels</button>
           <button id="btn_beach" class="btn btn-success" style="display: block; width: 100%;" value="color">Beach</button>
           <button id="btn_all" class="btn btn-alert" style="display: block; width: 100%;" value="color">All</button>
           <button id="btn_redcircles" class="btn btn-default" style="display: block; width: 100%;" value="color">Red Circles</button>
           <button id="btn_orangecircles" class="btn btn-default" style="display: block; width: 100%;" value="color">Orange Circles</button>
           <button id="btn_yellowcircles" class="btn btn-default" style="display: block; width: 100%;" value="color">Yellow Circles</button>
           <button id="btn_markers" class="btn btn-default" style="display: block; width: 100%;" value="gray">Markers</button>
        </div>
        
        <!-- # Map: Main map part -->
        <div class="col-md-10">
            <div id="mapid" style="height:500px"></div>
            
            <div class="panel panel-success">
              <div class="panel-heading">Places in area</div>
              <div class="panel-body" id="panel_info"></div>
            </div>
        </div>
    </div>
	<div id="mapCtrl"></div>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCa5u0jiFE4DNOxTMh8iTB-JHumUeZHomU&libraries=places&callback=initAutocomplete" async defer></script>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
   
    <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script>
  $( "#searchID" ).submit(function( event ) {
    event.preventDefault();
    $.post("/test", $("#searchID").serialize(), yelpSearchSuccess);
  });
  function yelpSearchSuccess(result){
    //You can get businesses which is returned as an array in this json format
    /*
      "businesses": [
    {
      "rating": 4,
      "price": "$",
      "phone": "+14152520800",
      "id": "four-barrel-coffee-san-francisco",
      "is_closed": false,
      "categories": [
        {
          "alias": "coffee",
          "title": "Coffee & Tea"
        }
      ],
      "review_count": 1738,
      "name": "Four Barrel Coffee",
      "url": "https://www.yelp.com/biz/four-barrel-coffee-san-francisco",
      "coordinates": {
        "latitude": 37.7670169511878,
        "longitude": -122.42184275
      },
      "image_url": "http://s3-media2.fl.yelpcdn.com/bphoto/MmgtASP3l_t4tPCL1iAsCg/o.jpg",
      "location": {
        "city": "San Francisco",
        "country": "US",
        "address2": "",
        "address3": "",
        "state": "CA",
        "address1": "375 Valencia St",
        "zip_code": "94103"
      },
      "distance": 1604.23,
      "transactions": ["pickup", "delivery"]
    },
    // ...
  ],


  Typically you can retrieve it after you stringify it then parse it as shown below.
  then they give you an array of businesses

  You can iterate through the array and reference them through dot notation as shown below
  */
    console.log("successful search Callback entering extraction");
    var strResult = JSON.stringify(result.businesses);
    var javaObject = JSON.parse(strResult);
    console.log(javaObject[0].review_count);
  }

  </script>
    <script src = "/js/map.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    
</body>

</html>